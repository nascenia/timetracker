= form_for(@goal, class: 'form-horizontal') do |f|
  - if @goal.errors.any?
    #error_explanation
      %h2= "#{pluralize(@goal.errors.count, 'error')} prohibited this goal from being saved:"

      %ul
        - @goal.errors.full_messages.each do |msg|
          %li= msg

  .row
    .col-md-4
      .form-group
        = f.label 'Persoonal or team'
        %br
        = f.radio_button :personal_or_team, "own", { checked: true }
        Own goal
        = f.radio_button :personal_or_team, "team"
        Team goal
    .col-md-4
      .form-group
        = f.label 'Team member'
        = f.select :user_id, @team.map{ |u| [u.name, u.id] }, { include_blank: 'select' }, class: 'form-control', disabled: 'disabled'
    .col-md-4
      .form-group
        = f.label 'Time period'
        = f.select :time_period, [['Q-1', '0'], ['Q-2', '1'], ['Q-3', '2'], ['Q-4', '3']], { include_blank: 'select'}, class: 'form-control'

  %hr
  .row
    .col-md-4
      .form-group
        = f.label :goal_category
        = f.select :goal_category, @goal_categories.map{ |d| [d.title, d.id] }, { include_blank: 'select' }, class: 'form-control'

    .col-md-4
      .form-group
        = f.label :start_date
        = f.text_field :start_date, class: 'form-control'

    .col-md-4
      .form-group
        = f.label :end_date
        = f.text_field :end_date, class: 'form-control'

  .row
    .col-md-8
      .form-group
        = f.label :title
        = f.text_field :title, class: 'form-control'
    .col-md-4
      .form-group
        = f.label :point
        = f.text_field :point, class: 'form-control'

  .row
    .col-md-12
      .form-group
        = f.label :description
        = f.text_area :description, class: 'form-control'
    
  .actions
    = f.submit class: 'btn btn-primary'

:javascript
  $(document).ready(function() {

    console.log('loading..');
    let year = new Date().getFullYear();
    let quaters = [
      { start_date: '01-01-' + year, end_date: '31-03-' + year },
      { start_date: '01-04-' + year, end_date: '30-06-' + year },
      { start_date: '01-07-' + year, end_date: '30-09-' + year },
      { start_date: '01-10-' + year, end_date: '31-12-' + year }
    ];

    $(document).on('click', 'input[type=radio]', function() {
      console.log('clicked');

      let selected = $('input[name="goal[personal_or_team]"]:checked').val();
      console.log(selected);
      if(selected == 'own') {
        $('#goal_user_id').prop('disabled', 'disabled');
      } else {
        $('#goal_user_id').prop('disabled', '');
      }
      
    });


    $(document).on('change', 'select#goal_time_period', function() {

      console.log('change');

      let selectedQuater = $(this).children("option:selected").val();
      console.log(quaters[selectedQuater]);


      $('#goal_start_date').val(quaters[selectedQuater].start_date);
      $('#goal_end_date').val(quaters[selectedQuater].end_date);

    });


  });