%h1 Summary of goals
%hr

- personal_or_team = params[:commit] == 'Search' ? params[:goal][:personal_or_team] : ''
- team_member   = params[:commit] == 'Search' ? params[:goal][:team_member] : ''
- year          = params[:commit] == 'Search' ? params[:goal][:year] : ''
- time_period   = params[:commit] == 'Search' ? params[:goal][:time_period] : ''
- start_date    = params[:commit] == 'Search' ? params[:goal][:start_date] : ''
- end_date      = params[:commit] == 'Search' ? params[:goal][:end_date] : ''
- url_params = { personal_or_team: personal_or_team, team_member: team_member, year: year, time_period: time_period, start_date: start_date, end_date: end_date }

= render 'search_form' 

%table.table
  %thead
    %tr
      %th Title
      %th Description
      %th Point
      %th % completed
      %th Achived point
      %th Start date
      %th End date
      %th Status
      %th

  %tbody
    - if @goals.size.zero?
      .alert.alert-danger
        No goal found!
    - @goals.each do |goal|
      %tr
        %td= goal.title
        %td= goal.description
        %td= goal.point
        %td= goal.percent_completed
        %td= goal.achived_point
        %td= goal.start_date
        %td= goal.end_date
        %td= goal.status.blank? ? '-' : Goal::STATUSES[goal.status]
        %td
          = link_to 'Show', goal_path(goal, goal: url_params, commit: 'Search')
          - if goal.status.eql?(0)
            |
            = link_to 'Edit', edit_goal_path(goal, goal: url_params, commit: 'Search') 
            |
            = link_to 'Destroy', goal, method: :delete, data: { confirm: 'Are you sure?' }
     
%br

= link_to 'New goal', new_goal_path, class: 'btn btn-primary'
